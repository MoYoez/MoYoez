!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("camelcase-keys")):"function"==typeof define&&define.amd?define(["exports","camelcase-keys"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["@mx-space/api-client"]={},t.camelcaseKeys$1)}(this,(function(t,e){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var s=r(e);const o=t=>n(t)&&"[object Object]"===Object.prototype.toString.call(t)&&Object.getPrototypeOf(t)===Object.prototype,n=t=>t&&"object"==typeof t,i=(t,e)=>{t&&n(e)&&(t.$raw&&Object.defineProperty(e,"$raw",{value:{...t.$raw},enumerable:!1}),t.$request&&Object.defineProperty(e,"$request",{value:{...t.$request},enumerable:!1}))};function a(t,{include:e,exclude:r}={}){const s=t=>{const s=e=>"string"==typeof e?t===e:e.test(t);return e?e.some(s):!r||!r.some(s)};for(const[e,r]of(t=>{const e=new Set;do{for(const r of Reflect.ownKeys(t))e.add([t,r])}while((t=Reflect.getPrototypeOf(t))&&t!==Object.prototype);return e})(t.constructor.prototype)){if("constructor"===r||!s(r))continue;const o=Reflect.getOwnPropertyDescriptor(e,r);o&&"function"==typeof o.value&&(t[r]=t[r].bind(t))}return t}class c{constructor(t){this.client=t,this.base="aggregate",this.name="aggregate",a(this)}get proxy(){return this.client.proxy(this.base)}getAggregateData(){return this.proxy.get()}getTop(t=5){return this.proxy.top.get({params:{size:t}})}getTimeline(t){const{sort:e,type:r,year:s}=t||{};return this.proxy.timeline.get({params:{sort:e&&(o=e,{asc:1,desc:-1}[o]||1),type:r,year:s}});var o}getStat(){return this.proxy.stat.get()}}class p extends Error{constructor(t,e,r,s){super(t),this.status=e,this.path=r,this.raw=s}}var l;t.CategoryType=void 0,(l=t.CategoryType||(t.CategoryType={}))[l.Category=0]="Category",l[l.Tag=1]="Tag";class y{constructor(t){this.client=t,this.name="category",this.base="categories",a(this)}get proxy(){return this.client.proxy(this.base)}getAllCategories(){return this.proxy.get({params:{type:t.CategoryType.Category}})}getAllTags(){return this.proxy.get({params:{type:t.CategoryType.Tag}})}async getCategoryDetail(t){if("string"==typeof t){const e=await this.proxy.get({params:{ids:t}}),r=Object.values(e.entries)[0];return i(e,r),r}if(Array.isArray(t)){const e=await this.proxy.get({params:{ids:t.join(",")}}),r=e?.entries;if(!r)throw new p("data structure error",500,e.$request.path,e);const s=new Map(Object.entries(r).map((([t,e])=>[t.toLowerCase(),e])));return i(e,s),s}}async getCategoryByIdOrSlug(t){return(t=>{if("object"!=typeof t)return t;if(null===t)return t;const e=t.data;if(o(e)&&1===Object.keys(t).length){const r=Object.assign({},e);return i(t,r),r}return t})(await this.proxy(t).get())}async getTagByName(t){return await this.proxy(t).get({params:{tag:1}})}}class h{constructor(t){this.client=t,this.base="comments",this.name="comment",a(this)}get proxy(){return this.client.proxy(this.base)}getById(t){return this.proxy(t).get()}getByRefId(t,e={}){const{page:r,size:s}=e;return this.proxy.ref(t).get({params:{page:r||1,size:s||10}})}comment(t,e){return this.proxy(t).post({data:e})}reply(t,e){return this.proxy.reply(t).post({data:e})}}class u{constructor(t){this.client=t,a(this)}get proxy(){return this.client.proxy(this.base)}getById(t){return this.proxy(t).get()}getAll(){return this.proxy.all.get()}getAllPaginated(t,e,r){return this.proxy.get({params:{page:t,size:e,...r}})}}class g extends u{constructor(t){super(t),this.client=t,this.name=["link","friend"],this.base="links",a(this)}async canApplyLink(){const{can:t}=await this.proxy.audit.get();return t}async applyLink(t){return await this.proxy.audit.post({data:t})}}class d{constructor(t){this.client=t,this.base="notes",this.name="note",a(this)}get proxy(){return this.client.proxy(this.base)}getLatest(){return this.proxy.latest.get()}getNoteById(...t){const[e,r,s=!1]=t;return"number"==typeof e?this.proxy.nid(e.toString()).get({params:{password:r,single:s?"1":void 0}}):this.proxy(e).get()}getList(t=1,e=10,r={}){const{select:s,sortBy:o,sortOrder:n,year:i}=r;return this.proxy.get({params:{page:t,size:e,select:s?.join(" "),sortBy:o,sortOrder:n,year:i}})}getMiddleList(t,e=5){return this.proxy.list(t).get({params:{size:e}})}likeIt(t){return this.proxy.like(t).get()}getNoteByTopicId(t,e=1,r=10,s={}){return this.proxy.topics(t).get({params:{page:e,size:r,...s}})}}class m{constructor(t){this.client=t,this.base="pages",this.name="page",a(this)}get proxy(){return this.client.proxy(this.base)}getList(t=1,e=10,r={}){const{select:s,sortBy:o,sortOrder:n}=r;return this.proxy.get({params:{page:t,size:e,select:s?.join(" "),sortBy:o,sortOrder:n}})}getById(t){return this.proxy(t).get()}getBySlug(t){return this.proxy.slug(t).get({})}}class f{constructor(t){this.client=t,this.base="posts",this.name="post",a(this)}get proxy(){return this.client.proxy(this.base)}getList(t=1,e=10,r={}){const{select:s,sortBy:o,sortOrder:n,year:i}=r;return this.proxy.get({params:{page:t,size:e,select:s?.join(" "),sortBy:o,sortOrder:n,year:i}})}getPost(t,e){return 1==arguments.length?this.proxy(t).get():this.proxy(t)(e).get()}getLatest(){return this.proxy.latest.get()}thumbsUp(t){return this.proxy("_thumbs-up").get({params:{id:t}})}}class x extends u{constructor(t){super(t),this.client=t,this.base="projects",this.name="project",a(this)}}class b{constructor(t){this.client=t,this.base="recently",this.name=["recently","shorthand"],a(this)}get proxy(){return this.client.proxy(this.base)}getLatestOne(){return this.proxy.latest.get()}getAll(){return this.proxy.all.get()}getList(t,e,r){return this.proxy.get({params:{before:t,after:e,size:r}})}}class C extends u{constructor(t){super(t),this.client=t,this.base="says",this.name="say",a(this)}get proxy(){return this.client.proxy(this.base)}getRandom(){return this.proxy.random.get()}}class j{constructor(t){this.client=t,this.base="search",this.name="search",a(this)}get proxy(){return this.client.proxy(this.base)}search(t,e,r={}){return this.proxy(t).get({params:{keyword:e,...r}})}searchByAlgolia(t,e){return this.proxy("algolia").get({params:{keyword:t,...e}})}}class w{constructor(t){this.client=t,this.base="serverless",this.name="serverless",a(this)}get proxy(){return this.client.proxy(this.base)}getByReferenceAndName(t,e){return this.proxy(t)(e).get()}}class T{constructor(t){this.client=t,this.base="snippets",this.name="snippet",a(this)}get proxy(){return this.client.proxy(this.base)}getByReferenceAndName(t,e){return this.proxy(t)(e).get()}}class O extends u{constructor(t){super(t),this.client=t,this.base="topics",this.name="topic",a(this)}get proxy(){return this.client.proxy(this.base)}getTopicBySlug(t){return this.proxy.slug(t).get()}}class P{constructor(t){this.client=t,this.base="master",this.name=["user","master"],a(this)}get proxy(){return this.client.proxy(this.base)}getMasterInfo(){return this.proxy.get()}login(t,e){return this.proxy.login.post({data:{username:t,password:e}})}checkTokenValid(t){return this.proxy.check_logged.get({params:{token:`bearer ${t.replace(/^Bearer\s/i,"")}`}})}}const $=[c,y,h,g,d,m,f,x,b,O,C,j,T,w,P],S=["aggregate","category","comment","link","note","page","post","project","topic","recently","say","search","snippet","serverless","user","friend","master","shorthand"],v=(t,e)=>(e.startsWith("/")||(e=`/${e}`),`${t}${e}`);function k(t){Object.defineProperty(t,"$$get",{value(e,r){const{params:s={}}=r,o=function(t){if(!t&&"object"!=typeof t)throw new TypeError("params must be object.");if(t instanceof URLSearchParams)return t.toString();const e=new URLSearchParams;return Object.entries(t).forEach((([t,r])=>{void 0!==r&&"[object Null]"!==Object.prototype.toString.call(r)&&e.set(t,r)})),e.toString()}(s);return t.instance.get(`${e}${o?`?${o}`:""}`,r)}}),["put","post","patch","delete"].forEach((e=>{Object.defineProperty(t,`$$${e}`,{value:(r,s)=>t.instance[e](r,s)})}))}class A{constructor(t,e,r={}){this._endpoint=t,this._adaptor=e,this.options=r,this._endpoint=t.replace(/\/*$/,"").replace("localhost","127.0.0.1"),this._proxy=this.buildRoute(this)(),this.initGetClient(),k(this)}initGetClient(){for(const t of S)Object.defineProperty(this,t,{get(){const e=Reflect.get(this,`_$${t}`);if(!e)throw new ReferenceError(`${t.charAt(0).toUpperCase()+t.slice(1)} Client not inject yet, please inject with client.injectClients(...)`);return e},configurable:!1,enumerable:!1})}injectControllers(t,...e){t=Array.isArray(t)?t:[t,...e];for(const e of t){const t=new e(this);if(Array.isArray(t.name))for(const e of t.name)r.call(this,e,t);else r.call(this,t.name,t)}function r(t,e){Object.defineProperty(this,`_$${t.toLowerCase()}`,{get:()=>e,enumerable:!1,configurable:!1})}}get endpoint(){return this._endpoint}get instance(){return this._adaptor}request(t){return this[`$$${String(t.method||"get").toLowerCase()}`](t.url,t)}get proxy(){return this._proxy}buildRoute(t){const e=()=>{},r=["get","post","delete","patch","put"],n=["toString","valueOf","inspect","constructor",Symbol.toPrimitive],i=this;return()=>{const a=[""],c={get:(l,y)=>n.includes(y)?t=>{if(t){const t=v(i.endpoint,a.join("/"));return a.length=0,t}{const t=a.join("/");return a.length=0,t.startsWith("/")?t:`/${t}`}}:r.includes(y)?async e=>{const r=v(i.endpoint,a.join("/"));let n;a.length=0;try{n=await t.request({method:y,...e,url:r})}catch(t){let e=t.message,s=t.code||t.status||t.statusCode||t.response?.status||t.response?.statusCode||t.response?.code||500;if(i.options.getCodeMessageFromException){const r=i.options.getCodeMessageFromException(t);e=r.message||e,s=r.code||s}throw new p(e,s,r,t)}const c=n.data;if(!c)return null;const l=Array.isArray(c)||o(c)?s.default(c,{deep:!0}):c;return l&&"object"==typeof l&&(Object.defineProperty(l,"$raw",{get:()=>n,enumerable:!1,configurable:!1}),Object.defineProperty(l,"$request",{get:()=>({url:r,method:y,options:e}),enumerable:!1})),l}:(a.push(y),new Proxy(e,c)),apply:(t,r,s)=>(a.push(...s.filter((t=>null!==t))),new Proxy(e,c))};return new Proxy(e,c)}}}var L,B,R,N,_,E,z;t.TimelineType=void 0,(L=t.TimelineType||(t.TimelineType={}))[L.Post=0]="Post",L[L.Note=1]="Note",t.RefType=void 0,(B=t.RefType||(t.RefType={})).Page="Page",B.Post="Post",B.Note="Note",t.CommentState=void 0,(R=t.CommentState||(t.CommentState={}))[R.Unread=0]="Unread",R[R.Read=1]="Read",R[R.Junk=2]="Junk",t.LinkType=void 0,(N=t.LinkType||(t.LinkType={}))[N.Friend=0]="Friend",N[N.Collection=1]="Collection",t.LinkState=void 0,(_=t.LinkState||(t.LinkState={}))[_.Pass=0]="Pass",_[_.Audit=1]="Audit",_[_.Outdate=2]="Outdate",_[_.Banned=3]="Banned",t.EnumPageType=void 0,(E=t.EnumPageType||(t.EnumPageType={})).md="md",E.html="html",E.frame="frame",t.SnippetType=void 0,(z=t.SnippetType||(t.SnippetType={})).JSON="json",z.Function="function",z.Text="text",z.YAML="yaml";const q=s.default;t.AggregateController=c,t.CategoryController=y,t.CommentController=h,t.LinkController=g,t.NoteController=d,t.PageController=m,t.PostController=f,t.ProjectController=x,t.RecentlyController=b,t.RequestError=p,t.SayController=C,t.SearchController=j,t.ServerlessController=w,t.SnippetController=T,t.TopicController=O,t.UserController=P,t.allContollerNames=S,t.allControllers=$,t.camelcaseKeys=q,t.camelcaseKeysDeep=t=>q(t,{deep:!0}),t.createClient=function(t){return(e,r)=>{const s=new A(e,t,r),{controllers:o}=r||{};return o&&s.injectControllers(o),s}},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.min.js.map
