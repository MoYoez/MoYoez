import t from"camelcase-keys";const e=t=>r(t)&&"[object Object]"===Object.prototype.toString.call(t)&&Object.getPrototypeOf(t)===Object.prototype,r=t=>t&&"object"==typeof t,s=(t,e)=>{t&&r(e)&&(t.$raw&&Object.defineProperty(e,"$raw",{value:{...t.$raw},enumerable:!1}),t.$request&&Object.defineProperty(e,"$request",{value:{...t.$request},enumerable:!1}))};function n(t,{include:e,exclude:r}={}){const s=t=>{const s=e=>"string"==typeof e?t===e:e.test(t);return e?e.some(s):!r||!r.some(s)};for(const[e,r]of(t=>{const e=new Set;do{for(const r of Reflect.ownKeys(t))e.add([t,r])}while((t=Reflect.getPrototypeOf(t))&&t!==Object.prototype);return e})(t.constructor.prototype)){if("constructor"===r||!s(r))continue;const n=Reflect.getOwnPropertyDescriptor(e,r);n&&"function"==typeof n.value&&(t[r]=t[r].bind(t))}return t}class o{constructor(t){this.client=t,this.base="aggregate",this.name="aggregate",n(this)}get proxy(){return this.client.proxy(this.base)}getAggregateData(){return this.proxy.get()}getTop(t=5){return this.proxy.top.get({params:{size:t}})}getTimeline(t){const{sort:e,type:r,year:s}=t||{};return this.proxy.timeline.get({params:{sort:e&&(n=e,{asc:1,desc:-1}[n]||1),type:r,year:s}});var n}getStat(){return this.proxy.stat.get()}}class i extends Error{constructor(t,e,r,s){super(t),this.status=e,this.path=r,this.raw=s}}var a;!function(t){t[t.Category=0]="Category",t[t.Tag=1]="Tag"}(a||(a={}));class c{constructor(t){this.client=t,this.name="category",this.base="categories",n(this)}get proxy(){return this.client.proxy(this.base)}getAllCategories(){return this.proxy.get({params:{type:a.Category}})}getAllTags(){return this.proxy.get({params:{type:a.Tag}})}async getCategoryDetail(t){if("string"==typeof t){const e=await this.proxy.get({params:{ids:t}}),r=Object.values(e.entries)[0];return s(e,r),r}if(Array.isArray(t)){const e=await this.proxy.get({params:{ids:t.join(",")}}),r=e?.entries;if(!r)throw new i("data structure error",500,e.$request.path,e);const n=new Map(Object.entries(r).map((([t,e])=>[t.toLowerCase(),e])));return s(e,n),n}}async getCategoryByIdOrSlug(t){return(t=>{if("object"!=typeof t)return t;if(null===t)return t;const r=t.data;if(e(r)&&1===Object.keys(t).length){const e=Object.assign({},r);return s(t,e),e}return t})(await this.proxy(t).get())}async getTagByName(t){return await this.proxy(t).get({params:{tag:1}})}}class p{constructor(t){this.client=t,this.base="comments",this.name="comment",n(this)}get proxy(){return this.client.proxy(this.base)}getById(t){return this.proxy(t).get()}getByRefId(t,e={}){const{page:r,size:s}=e;return this.proxy.ref(t).get({params:{page:r||1,size:s||10}})}comment(t,e){return this.proxy(t).post({data:e})}reply(t,e){return this.proxy.reply(t).post({data:e})}}class h{constructor(t){this.client=t,n(this)}get proxy(){return this.client.proxy(this.base)}getById(t){return this.proxy(t).get()}getAll(){return this.proxy.all.get()}getAllPaginated(t,e,r){return this.proxy.get({params:{page:t,size:e,...r}})}}class u extends h{constructor(t){super(t),this.client=t,this.name=["link","friend"],this.base="links",n(this)}async canApplyLink(){const{can:t}=await this.proxy.audit.get();return t}async applyLink(t){return await this.proxy.audit.post({data:t})}}class l{constructor(t){this.client=t,this.base="notes",this.name="note",n(this)}get proxy(){return this.client.proxy(this.base)}getLatest(){return this.proxy.latest.get()}getNoteById(...t){const[e,r,s=!1]=t;return"number"==typeof e?this.proxy.nid(e.toString()).get({params:{password:r,single:s?"1":void 0}}):this.proxy(e).get()}getList(t=1,e=10,r={}){const{select:s,sortBy:n,sortOrder:o,year:i}=r;return this.proxy.get({params:{page:t,size:e,select:s?.join(" "),sortBy:n,sortOrder:o,year:i}})}getMiddleList(t,e=5){return this.proxy.list(t).get({params:{size:e}})}likeIt(t){return this.proxy.like(t).get()}getNoteByTopicId(t,e=1,r=10,s={}){return this.proxy.topics(t).get({params:{page:e,size:r,...s}})}}class g{constructor(t){this.client=t,this.base="pages",this.name="page",n(this)}get proxy(){return this.client.proxy(this.base)}getList(t=1,e=10,r={}){const{select:s,sortBy:n,sortOrder:o}=r;return this.proxy.get({params:{page:t,size:e,select:s?.join(" "),sortBy:n,sortOrder:o}})}getById(t){return this.proxy(t).get()}getBySlug(t){return this.proxy.slug(t).get({})}}class y{constructor(t){this.client=t,this.base="posts",this.name="post",n(this)}get proxy(){return this.client.proxy(this.base)}getList(t=1,e=10,r={}){const{select:s,sortBy:n,sortOrder:o,year:i}=r;return this.proxy.get({params:{page:t,size:e,select:s?.join(" "),sortBy:n,sortOrder:o,year:i}})}getPost(t,e){return 1==arguments.length?this.proxy(t).get():this.proxy(t)(e).get()}getLatest(){return this.proxy.latest.get()}thumbsUp(t){return this.proxy("_thumbs-up").get({params:{id:t}})}}class d extends h{constructor(t){super(t),this.client=t,this.base="projects",this.name="project",n(this)}}class m{constructor(t){this.client=t,this.base="recently",this.name=["recently","shorthand"],n(this)}get proxy(){return this.client.proxy(this.base)}getLatestOne(){return this.proxy.latest.get()}getAll(){return this.proxy.all.get()}getList(t,e,r){return this.proxy.get({params:{before:t,after:e,size:r}})}}class x extends h{constructor(t){super(t),this.client=t,this.base="says",this.name="say",n(this)}get proxy(){return this.client.proxy(this.base)}getRandom(){return this.proxy.random.get()}}class f{constructor(t){this.client=t,this.base="search",this.name="search",n(this)}get proxy(){return this.client.proxy(this.base)}search(t,e,r={}){return this.proxy(t).get({params:{keyword:e,...r}})}searchByAlgolia(t,e){return this.proxy("algolia").get({params:{keyword:t,...e}})}}class b{constructor(t){this.client=t,this.base="serverless",this.name="serverless",n(this)}get proxy(){return this.client.proxy(this.base)}getByReferenceAndName(t,e){return this.proxy(t)(e).get()}}class j{constructor(t){this.client=t,this.base="snippets",this.name="snippet",n(this)}get proxy(){return this.client.proxy(this.base)}getByReferenceAndName(t,e){return this.proxy(t)(e).get()}}class w extends h{constructor(t){super(t),this.client=t,this.base="topics",this.name="topic",n(this)}get proxy(){return this.client.proxy(this.base)}getTopicBySlug(t){return this.proxy.slug(t).get()}}class O{constructor(t){this.client=t,this.base="master",this.name=["user","master"],n(this)}get proxy(){return this.client.proxy(this.base)}getMasterInfo(){return this.proxy.get()}login(t,e){return this.proxy.login.post({data:{username:t,password:e}})}checkTokenValid(t){return this.proxy.check_logged.get({params:{token:`bearer ${t.replace(/^Bearer\s/i,"")}`}})}}const $=[o,c,p,u,l,g,y,d,m,w,x,f,j,b,O],P=["aggregate","category","comment","link","note","page","post","project","topic","recently","say","search","snippet","serverless","user","friend","master","shorthand"],A=(t,e)=>(e.startsWith("/")||(e=`/${e}`),`${t}${e}`);function B(t){Object.defineProperty(t,"$$get",{value(e,r){const{params:s={}}=r,n=function(t){if(!t&&"object"!=typeof t)throw new TypeError("params must be object.");if(t instanceof URLSearchParams)return t.toString();const e=new URLSearchParams;return Object.entries(t).forEach((([t,r])=>{void 0!==r&&"[object Null]"!==Object.prototype.toString.call(r)&&e.set(t,r)})),e.toString()}(s);return t.instance.get(`${e}${n?`?${n}`:""}`,r)}}),["put","post","patch","delete"].forEach((e=>{Object.defineProperty(t,`$$${e}`,{value:(r,s)=>t.instance[e](r,s)})}))}class C{constructor(t,e,r={}){this._endpoint=t,this._adaptor=e,this.options=r,this._endpoint=t.replace(/\/*$/,"").replace("localhost","127.0.0.1"),this._proxy=this.buildRoute(this)(),this.initGetClient(),B(this)}initGetClient(){for(const t of P)Object.defineProperty(this,t,{get(){const e=Reflect.get(this,`_$${t}`);if(!e)throw new ReferenceError(`${t.charAt(0).toUpperCase()+t.slice(1)} Client not inject yet, please inject with client.injectClients(...)`);return e},configurable:!1,enumerable:!1})}injectControllers(t,...e){t=Array.isArray(t)?t:[t,...e];for(const e of t){const t=new e(this);if(Array.isArray(t.name))for(const e of t.name)r.call(this,e,t);else r.call(this,t.name,t)}function r(t,e){Object.defineProperty(this,`_$${t.toLowerCase()}`,{get:()=>e,enumerable:!1,configurable:!1})}}get endpoint(){return this._endpoint}get instance(){return this._adaptor}request(t){return this[`$$${String(t.method||"get").toLowerCase()}`](t.url,t)}get proxy(){return this._proxy}buildRoute(r){const s=()=>{},n=["get","post","delete","patch","put"],o=["toString","valueOf","inspect","constructor",Symbol.toPrimitive],a=this;return()=>{const c=[""],p={get:(h,u)=>o.includes(u)?t=>{if(t){const t=A(a.endpoint,c.join("/"));return c.length=0,t}{const t=c.join("/");return c.length=0,t.startsWith("/")?t:`/${t}`}}:n.includes(u)?async s=>{const n=A(a.endpoint,c.join("/"));let o;c.length=0;try{o=await r.request({method:u,...s,url:n})}catch(t){let e=t.message,r=t.code||t.status||t.statusCode||t.response?.status||t.response?.statusCode||t.response?.code||500;if(a.options.getCodeMessageFromException){const s=a.options.getCodeMessageFromException(t);e=s.message||e,r=s.code||r}throw new i(e,r,n,t)}const p=o.data;if(!p)return null;const h=Array.isArray(p)||e(p)?t(p,{deep:!0}):p;return h&&"object"==typeof h&&(Object.defineProperty(h,"$raw",{get:()=>o,enumerable:!1,configurable:!1}),Object.defineProperty(h,"$request",{get:()=>({url:n,method:u,options:s}),enumerable:!1})),h}:(c.push(u),new Proxy(s,p)),apply:(t,e,r)=>(c.push(...r.filter((t=>null!==t))),new Proxy(s,p))};return new Proxy(s,p)}}}function k(t){return(e,r)=>{const s=new C(e,t,r),{controllers:n}=r||{};return n&&s.injectControllers(n),s}}var v,L,S,R,T,N,_;!function(t){t[t.Post=0]="Post",t[t.Note=1]="Note"}(v||(v={})),function(t){t.Page="Page",t.Post="Post",t.Note="Note"}(L||(L={})),function(t){t[t.Unread=0]="Unread",t[t.Read=1]="Read",t[t.Junk=2]="Junk"}(S||(S={})),function(t){t[t.Friend=0]="Friend",t[t.Collection=1]="Collection"}(R||(R={})),function(t){t[t.Pass=0]="Pass",t[t.Audit=1]="Audit",t[t.Outdate=2]="Outdate",t[t.Banned=3]="Banned"}(T||(T={})),function(t){t.md="md",t.html="html",t.frame="frame"}(N||(N={})),function(t){t.JSON="json",t.Function="function",t.Text="text",t.YAML="yaml"}(_||(_={}));const z=t=>I(t,{deep:!0}),I=t;export{o as AggregateController,c as CategoryController,a as CategoryType,p as CommentController,S as CommentState,N as EnumPageType,u as LinkController,T as LinkState,R as LinkType,l as NoteController,g as PageController,y as PostController,d as ProjectController,m as RecentlyController,L as RefType,i as RequestError,x as SayController,f as SearchController,b as ServerlessController,j as SnippetController,_ as SnippetType,v as TimelineType,w as TopicController,O as UserController,P as allContollerNames,$ as allControllers,I as camelcaseKeys,z as camelcaseKeysDeep,k as createClient};
//# sourceMappingURL=index.esm.min.js.map
