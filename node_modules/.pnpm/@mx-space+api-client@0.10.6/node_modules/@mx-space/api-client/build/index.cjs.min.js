"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var e=t(require("camelcase-keys"));const r=t=>s(t)&&"[object Object]"===Object.prototype.toString.call(t)&&Object.getPrototypeOf(t)===Object.prototype,s=t=>t&&"object"==typeof t,o=(t,e)=>{t&&s(e)&&(t.$raw&&Object.defineProperty(e,"$raw",{value:{...t.$raw},enumerable:!1}),t.$request&&Object.defineProperty(e,"$request",{value:{...t.$request},enumerable:!1}))};function n(t,{include:e,exclude:r}={}){const s=t=>{const s=e=>"string"==typeof e?t===e:e.test(t);return e?e.some(s):!r||!r.some(s)};for(const[e,r]of(t=>{const e=new Set;do{for(const r of Reflect.ownKeys(t))e.add([t,r])}while((t=Reflect.getPrototypeOf(t))&&t!==Object.prototype);return e})(t.constructor.prototype)){if("constructor"===r||!s(r))continue;const o=Reflect.getOwnPropertyDescriptor(e,r);o&&"function"==typeof o.value&&(t[r]=t[r].bind(t))}return t}class i{constructor(t){this.client=t,this.base="aggregate",this.name="aggregate",n(this)}get proxy(){return this.client.proxy(this.base)}getAggregateData(){return this.proxy.get()}getTop(t=5){return this.proxy.top.get({params:{size:t}})}getTimeline(t){const{sort:e,type:r,year:s}=t||{};return this.proxy.timeline.get({params:{sort:e&&(o=e,{asc:1,desc:-1}[o]||1),type:r,year:s}});var o}getStat(){return this.proxy.stat.get()}}class a extends Error{constructor(t,e,r,s){super(t),this.status=e,this.path=r,this.raw=s}}var p;exports.CategoryType=void 0,(p=exports.CategoryType||(exports.CategoryType={}))[p.Category=0]="Category",p[p.Tag=1]="Tag";class c{constructor(t){this.client=t,this.name="category",this.base="categories",n(this)}get proxy(){return this.client.proxy(this.base)}getAllCategories(){return this.proxy.get({params:{type:exports.CategoryType.Category}})}getAllTags(){return this.proxy.get({params:{type:exports.CategoryType.Tag}})}async getCategoryDetail(t){if("string"==typeof t){const e=await this.proxy.get({params:{ids:t}}),r=Object.values(e.entries)[0];return o(e,r),r}if(Array.isArray(t)){const e=await this.proxy.get({params:{ids:t.join(",")}}),r=e?.entries;if(!r)throw new a("data structure error",500,e.$request.path,e);const s=new Map(Object.entries(r).map((([t,e])=>[t.toLowerCase(),e])));return o(e,s),s}}async getCategoryByIdOrSlug(t){return(t=>{if("object"!=typeof t)return t;if(null===t)return t;const e=t.data;if(r(e)&&1===Object.keys(t).length){const r=Object.assign({},e);return o(t,r),r}return t})(await this.proxy(t).get())}async getTagByName(t){return await this.proxy(t).get({params:{tag:1}})}}class l{constructor(t){this.client=t,this.base="comments",this.name="comment",n(this)}get proxy(){return this.client.proxy(this.base)}getById(t){return this.proxy(t).get()}getByRefId(t,e={}){const{page:r,size:s}=e;return this.proxy.ref(t).get({params:{page:r||1,size:s||10}})}comment(t,e){return this.proxy(t).post({data:e})}reply(t,e){return this.proxy.reply(t).post({data:e})}}class y{constructor(t){this.client=t,n(this)}get proxy(){return this.client.proxy(this.base)}getById(t){return this.proxy(t).get()}getAll(){return this.proxy.all.get()}getAllPaginated(t,e,r){return this.proxy.get({params:{page:t,size:e,...r}})}}class h extends y{constructor(t){super(t),this.client=t,this.name=["link","friend"],this.base="links",n(this)}async canApplyLink(){const{can:t}=await this.proxy.audit.get();return t}async applyLink(t){return await this.proxy.audit.post({data:t})}}class u{constructor(t){this.client=t,this.base="notes",this.name="note",n(this)}get proxy(){return this.client.proxy(this.base)}getLatest(){return this.proxy.latest.get()}getNoteById(...t){const[e,r,s=!1]=t;return"number"==typeof e?this.proxy.nid(e.toString()).get({params:{password:r,single:s?"1":void 0}}):this.proxy(e).get()}getList(t=1,e=10,r={}){const{select:s,sortBy:o,sortOrder:n,year:i}=r;return this.proxy.get({params:{page:t,size:e,select:s?.join(" "),sortBy:o,sortOrder:n,year:i}})}getMiddleList(t,e=5){return this.proxy.list(t).get({params:{size:e}})}likeIt(t){return this.proxy.like(t).get()}getNoteByTopicId(t,e=1,r=10,s={}){return this.proxy.topics(t).get({params:{page:e,size:r,...s}})}}class g{constructor(t){this.client=t,this.base="pages",this.name="page",n(this)}get proxy(){return this.client.proxy(this.base)}getList(t=1,e=10,r={}){const{select:s,sortBy:o,sortOrder:n}=r;return this.proxy.get({params:{page:t,size:e,select:s?.join(" "),sortBy:o,sortOrder:n}})}getById(t){return this.proxy(t).get()}getBySlug(t){return this.proxy.slug(t).get({})}}class x{constructor(t){this.client=t,this.base="posts",this.name="post",n(this)}get proxy(){return this.client.proxy(this.base)}getList(t=1,e=10,r={}){const{select:s,sortBy:o,sortOrder:n,year:i}=r;return this.proxy.get({params:{page:t,size:e,select:s?.join(" "),sortBy:o,sortOrder:n,year:i}})}getPost(t,e){return 1==arguments.length?this.proxy(t).get():this.proxy(t)(e).get()}getLatest(){return this.proxy.latest.get()}thumbsUp(t){return this.proxy("_thumbs-up").get({params:{id:t}})}}class d extends y{constructor(t){super(t),this.client=t,this.base="projects",this.name="project",n(this)}}class m{constructor(t){this.client=t,this.base="recently",this.name=["recently","shorthand"],n(this)}get proxy(){return this.client.proxy(this.base)}getLatestOne(){return this.proxy.latest.get()}getAll(){return this.proxy.all.get()}getList(t,e,r){return this.proxy.get({params:{before:t,after:e,size:r}})}}class f extends y{constructor(t){super(t),this.client=t,this.base="says",this.name="say",n(this)}get proxy(){return this.client.proxy(this.base)}getRandom(){return this.proxy.random.get()}}class b{constructor(t){this.client=t,this.base="search",this.name="search",n(this)}get proxy(){return this.client.proxy(this.base)}search(t,e,r={}){return this.proxy(t).get({params:{keyword:e,...r}})}searchByAlgolia(t,e){return this.proxy("algolia").get({params:{keyword:t,...e}})}}class C{constructor(t){this.client=t,this.base="serverless",this.name="serverless",n(this)}get proxy(){return this.client.proxy(this.base)}getByReferenceAndName(t,e){return this.proxy(t)(e).get()}}class j{constructor(t){this.client=t,this.base="snippets",this.name="snippet",n(this)}get proxy(){return this.client.proxy(this.base)}getByReferenceAndName(t,e){return this.proxy(t)(e).get()}}class w extends y{constructor(t){super(t),this.client=t,this.base="topics",this.name="topic",n(this)}get proxy(){return this.client.proxy(this.base)}getTopicBySlug(t){return this.proxy.slug(t).get()}}class T{constructor(t){this.client=t,this.base="master",this.name=["user","master"],n(this)}get proxy(){return this.client.proxy(this.base)}getMasterInfo(){return this.proxy.get()}login(t,e){return this.proxy.login.post({data:{username:t,password:e}})}checkTokenValid(t){return this.proxy.check_logged.get({params:{token:`bearer ${t.replace(/^Bearer\s/i,"")}`}})}}const O=[i,c,l,h,u,g,x,d,m,w,f,b,j,C,T],P=["aggregate","category","comment","link","note","page","post","project","topic","recently","say","search","snippet","serverless","user","friend","master","shorthand"],$=(t,e)=>(e.startsWith("/")||(e=`/${e}`),`${t}${e}`);function S(t){Object.defineProperty(t,"$$get",{value(e,r){const{params:s={}}=r,o=function(t){if(!t&&"object"!=typeof t)throw new TypeError("params must be object.");if(t instanceof URLSearchParams)return t.toString();const e=new URLSearchParams;return Object.entries(t).forEach((([t,r])=>{void 0!==r&&"[object Null]"!==Object.prototype.toString.call(r)&&e.set(t,r)})),e.toString()}(s);return t.instance.get(`${e}${o?`?${o}`:""}`,r)}}),["put","post","patch","delete"].forEach((e=>{Object.defineProperty(t,`$$${e}`,{value:(r,s)=>t.instance[e](r,s)})}))}class v{constructor(t,e,r={}){this._endpoint=t,this._adaptor=e,this.options=r,this._endpoint=t.replace(/\/*$/,"").replace("localhost","127.0.0.1"),this._proxy=this.buildRoute(this)(),this.initGetClient(),S(this)}initGetClient(){for(const t of P)Object.defineProperty(this,t,{get(){const e=Reflect.get(this,`_$${t}`);if(!e)throw new ReferenceError(`${t.charAt(0).toUpperCase()+t.slice(1)} Client not inject yet, please inject with client.injectClients(...)`);return e},configurable:!1,enumerable:!1})}injectControllers(t,...e){t=Array.isArray(t)?t:[t,...e];for(const e of t){const t=new e(this);if(Array.isArray(t.name))for(const e of t.name)r.call(this,e,t);else r.call(this,t.name,t)}function r(t,e){Object.defineProperty(this,`_$${t.toLowerCase()}`,{get:()=>e,enumerable:!1,configurable:!1})}}get endpoint(){return this._endpoint}get instance(){return this._adaptor}request(t){return this[`$$${String(t.method||"get").toLowerCase()}`](t.url,t)}get proxy(){return this._proxy}buildRoute(t){const s=()=>{},o=["get","post","delete","patch","put"],n=["toString","valueOf","inspect","constructor",Symbol.toPrimitive],i=this;return()=>{const p=[""],c={get:(l,y)=>n.includes(y)?t=>{if(t){const t=$(i.endpoint,p.join("/"));return p.length=0,t}{const t=p.join("/");return p.length=0,t.startsWith("/")?t:`/${t}`}}:o.includes(y)?async s=>{const o=$(i.endpoint,p.join("/"));let n;p.length=0;try{n=await t.request({method:y,...s,url:o})}catch(t){let e=t.message,r=t.code||t.status||t.statusCode||t.response?.status||t.response?.statusCode||t.response?.code||500;if(i.options.getCodeMessageFromException){const s=i.options.getCodeMessageFromException(t);e=s.message||e,r=s.code||r}throw new a(e,r,o,t)}const c=n.data;if(!c)return null;const l=Array.isArray(c)||r(c)?e.default(c,{deep:!0}):c;return l&&"object"==typeof l&&(Object.defineProperty(l,"$raw",{get:()=>n,enumerable:!1,configurable:!1}),Object.defineProperty(l,"$request",{get:()=>({url:o,method:y,options:s}),enumerable:!1})),l}:(p.push(y),new Proxy(s,c)),apply:(t,e,r)=>(p.push(...r.filter((t=>null!==t))),new Proxy(s,c))};return new Proxy(s,c)}}}var k,A,L,B,R,N,_;exports.TimelineType=void 0,(k=exports.TimelineType||(exports.TimelineType={}))[k.Post=0]="Post",k[k.Note=1]="Note",exports.RefType=void 0,(A=exports.RefType||(exports.RefType={})).Page="Page",A.Post="Post",A.Note="Note",exports.CommentState=void 0,(L=exports.CommentState||(exports.CommentState={}))[L.Unread=0]="Unread",L[L.Read=1]="Read",L[L.Junk=2]="Junk",exports.LinkType=void 0,(B=exports.LinkType||(exports.LinkType={}))[B.Friend=0]="Friend",B[B.Collection=1]="Collection",exports.LinkState=void 0,(R=exports.LinkState||(exports.LinkState={}))[R.Pass=0]="Pass",R[R.Audit=1]="Audit",R[R.Outdate=2]="Outdate",R[R.Banned=3]="Banned",exports.EnumPageType=void 0,(N=exports.EnumPageType||(exports.EnumPageType={})).md="md",N.html="html",N.frame="frame",exports.SnippetType=void 0,(_=exports.SnippetType||(exports.SnippetType={})).JSON="json",_.Function="function",_.Text="text",_.YAML="yaml";const E=e.default;exports.AggregateController=i,exports.CategoryController=c,exports.CommentController=l,exports.LinkController=h,exports.NoteController=u,exports.PageController=g,exports.PostController=x,exports.ProjectController=d,exports.RecentlyController=m,exports.RequestError=a,exports.SayController=f,exports.SearchController=b,exports.ServerlessController=C,exports.SnippetController=j,exports.TopicController=w,exports.UserController=T,exports.allContollerNames=P,exports.allControllers=O,exports.camelcaseKeys=E,exports.camelcaseKeysDeep=t=>E(t,{deep:!0}),exports.createClient=function(t){return(e,r)=>{const s=new v(e,t,r),{controllers:o}=r||{};return o&&s.injectControllers(o),s}};
//# sourceMappingURL=index.cjs.min.js.map
